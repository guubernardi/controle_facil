<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Devolução - Controle Fácil</title>
  <meta name="description" content="Editar dados, valores e histórico de uma devolução." />
  
  <!-- Fontes -->
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="icon" href="assets/img/favicon.png" type="image/png"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"/>

  <!-- Estilos -->
  <link rel="stylesheet" href="css/devolucao.css">
</head>
<body class="devolucao-page">

  <!-- Topbar mínima -->
  <div class="topbar-mini">
    <a href="index.html" class="voltar" aria-label="Voltar para Devoluções">
      <svg class="ico" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
        <path d="M15 18l-6-6 6-6"/>
      </svg>
      <span>Voltar</span>
    </a>
  </div>

  <main class="page-wrap" role="main">
    <header class="page-head">
      <div>
        <h1 class="title">Devolução <span id="dv-id" class="kbd" aria-live="polite"></span></h1>
        <p class="hint">
          <strong>Regras:</strong> Rejeitado = R$ 0,00 · Motivo do cliente = R$ 0,00 · Recebido no CD/Inspeção = só frete
          <span id="auto-hint" style="margin-left:.5rem; opacity:.9;"></span>
        </p>
      </div>

      <div class="actions" role="group" aria-label="Ações da devolução">
        <button id="btn-enrich" class="btn btn--ghost btn--lg" type="button" title="Atualizar dados a partir do ML">
          <svg class="btn__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <path d="M21 12a9 9 0 1 1-3-6.7M21 3v6h-6"/>
          </svg>
          <span>Atualizar dados (ML)</span>
        </button>

        <span class="actions-split"></span>

        <button id="btn-insp-aprova" class="btn btn--success btn--lg" type="button" title="Inspeção aprovada">
          <svg class="btn__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <path d="M20 6L9 17l-5-5"/>
          </svg>
          <span>Inspeção: Aprovar</span>
        </button>

        <button id="btn-insp-reprova" class="btn btn--danger btn--lg" type="button" title="Inspeção reprovada">
          <svg class="btn__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
          <span>Inspeção: Reprovar</span>
        </button>

        <button id="btn-salvar" class="btn btn--primary btn--lg" type="button" title="Salvar alterações (Ctrl/Cmd+S)">
          <svg class="btn__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"/>
            <path d="M17 21v-8H7v8M7 3v5h8"/>
          </svg>
          <span>Salvar</span>
        </button>
      </div>
    </header>

    <!-- Dialog: Recebido no CD -->
    <dialog id="dlg-recebido" aria-labelledby="rcd-title">
      <form method="dialog" id="rcd-form">
        <h3 id="rcd-title">Recebido no CD</h3>
        <p class="dialog-desc">Registre quando o produto foi recebido no centro de distribuição.</p>

        <div class="dialog-grid">
          <label for="rcd-resp">Responsável</label>
          <input id="rcd-resp" type="text" placeholder="Ex.: João (CD)" autocomplete="off">

          <label for="rcd-when">Data/Hora</label>
          <input id="rcd-when" type="datetime-local">
        </div>

        <div class="dialog-actions">
          <button id="rcd-unset" type="button" class="btn btn--outline">Não foi recebido</button>
          <div class="dialog-actions-right">
            <button type="button" class="btn btn--ghost" id="rcd-cancel">Cancelar</button>
            <button id="rcd-save" type="submit" class="btn btn--primary">Salvar</button>
          </div>
        </div>

        <p class="dialog-hint">
          Dica: se deixar o responsável vazio, será usado <b>"cd"</b>. Se não escolher uma data, uso a data/hora atual.
        </p>
      </form>
    </dialog>

    <!-- Dialog: Inspeção -->
    <dialog id="dlg-inspecao" aria-labelledby="insp-title">
      <form method="dialog" id="insp-form">
        <h3 id="insp-title">Inspeção</h3>
        <div id="insp-sub" class="dialog-subtitle"></div>

        <label for="insp-text" class="dialog-label">Observação (opcional)</label>
        <textarea id="insp-text" rows="4" placeholder="Adicione detalhes sobre a inspeção..."></textarea>

        <div class="dialog-actions-simple">
          <button type="button" class="btn btn--ghost" id="insp-cancel">Cancelar</button>
          <button type="submit" class="btn btn--primary" id="insp-confirm">Confirmar</button>
        </div>
      </form>
    </dialog>

    <div class="grid">
      <!-- Dados -->
      <section class="card" aria-labelledby="sec-dados">
        <h2 id="sec-dados">Dados da Devolução</h2>

        <div class="row">
          <label for="id_venda">Número do Pedido</label>
          <input id="id_venda" name="id_venda" type="text" placeholder="Ex.: 12345 / TESTE-001" autocomplete="off">
        </div>

        <div class="row">
          <label for="cliente_nome">Cliente</label>
          <input id="cliente_nome" name="cliente_nome" type="text" placeholder="Nome do cliente" autocomplete="name">
        </div>

        <div class="row-group">
          <div class="row">
            <label for="loja_nome">Loja (apelido no canal)</label>
            <input id="loja_nome" name="loja_nome" type="text" placeholder="Ex.: Minha Loja Oficial" autocomplete="organization">
          </div>
          <div class="row">
            <label for="data_compra">Data da compra</label>
            <input id="data_compra" name="data_compra" type="date" inputmode="numeric">
          </div>
        </div>

        <div class="row-group">
          <div class="row">
            <label for="status">Status (interno)</label>
            <select id="status" name="status">
              <option value="">—</option>
              <option value="pendente">Pendente</option>
              <option value="em_analise">Em análise</option>
              <option value="aprovado">Aprovado</option>
              <option value="rejeitado">Rejeitado</option>
              <option value="cancelado">Cancelado</option>
            </select>
          </div>

          <div class="row">
            <label for="tipo_reclamacao">Motivo da reclamação</label>
            <select id="tipo_reclamacao" name="tipo_reclamacao">
              <option value="">—</option>
              <option value="produto_defeituoso">Produto defeituoso</option>
              <option value="produto_danificado">Produto danificado</option>
              <option value="nao_corresponde">Não corresponde à descrição</option>
              <option value="arrependimento_cliente">Arrependimento do cliente</option>
              <option value="entrega_atrasada">Entrega atrasada</option>
            </select>
          </div>
        </div>

        <div class="row">
          <label for="sku">SKU / Item ID</label>
          <input id="sku" name="sku" type="text" placeholder="Ex.: SKU-12345" autocomplete="off">
        </div>
      </section>

      <!-- Valores -->
      <section class="card" aria-labelledby="sec-valores">
        <h2 id="sec-valores">Valores</h2>

        <div class="row">
          <label for="valor_produto">Valor do Produto</label>
          <input id="valor_produto" name="valor_produto" type="text" placeholder="0,00" inputmode="decimal">
        </div>

        <div class="row">
          <label for="valor_frete">Valor do Frete</label>
          <input id="valor_frete" name="valor_frete" type="text" placeholder="0,00" inputmode="decimal">
        </div>

        <div class="row">
          <label for="valor_total">Valor Total a Reembolsar</label>
          <input id="valor_total" name="valor_total" type="text" placeholder="0,00" inputmode="decimal" class="font-semibold">
        </div>

        <div class="status-box">
          <div class="status-item">
            <span class="status-label">Status da Logística</span>
            <span id="pill-log" class="pill -neutro">Pendente</span>
          </div>

          <div class="status-item">
            <span class="status-label">Recebimento no CD</span>
            <button type="button" class="btn btn--sm btn--outline" id="btn-cd">Gerenciar</button>
          </div>

          <div id="cd-info" class="cd-details" hidden>
            <span id="pill-cd" class="pill -neutro">Não recebido</span>
            <span id="cd-sep" class="cd-sep" hidden>·</span>
            <span id="cd-resp" class="cd-text" hidden></span>
            <span id="cd-when" class="cd-text" hidden></span>
          </div>
        </div>
      </section>

      <!-- Nota Fiscal -->
      <section class="card" aria-labelledby="sec-nfe">
        <h2 id="sec-nfe">Nota Fiscal</h2>

        <div class="row">
          <label for="nfe_numero">Número da NF-e</label>
          <input id="nfe_numero" name="nfe_numero" type="text" placeholder="Ex.: 12345" autocomplete="off">
        </div>

        <div class="row">
          <label for="nfe_chave">Chave de acesso (44 dígitos)</label>
          <input id="nfe_chave" name="nfe_chave" type="text" placeholder="35240112345678901234567890123456789012345678" maxlength="44" class="font-mono">
        </div>
      </section>

      <!-- Observações -->
      <section class="card" aria-labelledby="sec-obs">
        <h2 id="sec-obs">Observações</h2>

        <div class="row">
          <label for="reclamacao">Detalhes da reclamação</label>
          <textarea id="reclamacao" name="reclamacao" rows="6" placeholder="Descreva o motivo da devolução..."></textarea>
        </div>
      </section>
    </div>
  </main>

  <!-- Toast -->
  <div id="toast" class="toast"></div>

  <!-- Scripts -->
  <script src="js/devolucao-editar.js"></script>
</body>
</html>
