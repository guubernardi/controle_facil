<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Registros - Controle Facil</title>
  <meta name="description" content="Gerencie e visualize todos os registros de devoluções do sistema" />

  <!-- estilos -->
  <link rel="stylesheet" href="css/navbar.css" />
  <link rel="stylesheet" href="css/index.css" />

  <link rel="icon" href="assets/img/logo_rf.png" type="image/png" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
</head>
<body>
  <!-- NAVBAR PADRÃO -->
  <div id="app-navbar"></div>

  <!-- cabeçalho da página (hero) -->
  <header class="cabecalho">
    <div class="container">
      <div class="cabecalho-conteudo">
        <div class="logo-area">
          <div class="icone-sistema">
            <img src="assets/img/logo_rf.png" alt="Ícone do Sistema" class="icone-principal" />
            <div class="badge-status">
              <svg class="icone-raio" fill="currentColor" viewBox="0 0 20 20">
                <path d="M11 3L6 9h4l-1 8 5-6h-4l1-8z" />
              </svg>
            </div>
          </div>
          <div>
            <h1 class="titulo-principal">Registros</h1>
            <p class="subtitulo">
              <svg class="icone-trending" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
              </svg>
              Controle completo dos registros
            </p>
          </div>
        </div>

        <div class="acoes-cabecalho">
          <button class="botao botao-outline" onclick="forcarSincronizacao()" title="Sincronizar com servidor">
            <svg class="icone" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v6h6M20 20v-6h-6"/>
            </svg>
            Sincronizar
          </button>
          <a class="botao botao-outline" href="index.html">
            <svg class="icone" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
            </svg>
            Voltar ao Dashboard
          </a>

          <button class="botao botao-principal" onclick="abrirModalNovoRegistro()">
            <svg class="icone" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
            </svg>
            Novo Registro
          </button>
        </div>
      </div>
    </div>
  </header>

  <main class="conteudo-principal">
    <div class="container">
      <!-- Estatísticas Rápidas -->
      <section class="secao-estatisticas">
        <div class="grade-cards">
          <div class="card-estatistica">
            <div class="card-header">
              <span class="card-titulo">Total de Registros</span>
              <svg class="icone-card" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
              </svg>
            </div>
            <div class="numero-principal" id="totalRegistros">0</div>
            <p class="descricao-card">Todos os registros cadastrados</p>
          </div>

          <!-- NOVO CARD: Valor total -->
          <div class="card-estatistica">
            <div class="card-header">
              <span class="card-titulo">Valor total</span>
              <svg class="icone-card" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
              </svg>
            </div>
            <div class="numero-principal" id="registrosValorTotal">R$ 0,00</div>
            <p class="descricao-card">Soma dos valores dos registros</p>
          </div>
          <!-- FIM NOVO CARD -->

          <div class="card-estatistica">
            <div class="card-header">
              <span class="card-titulo">Registros Ativos</span>
              <svg class="icone-card icone-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </div>
            <div class="numero-principal numero-secondary" id="registrosAtivos">0</div>
            <p class="descricao-card">Registros em andamento</p>
          </div>

          <div class="card-estatistica">
            <div class="card-header">
              <span class="card-titulo">Registros Pendentes</span>
              <svg class="icone-card icone-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </div>
            <div class="numero-principal numero-accent" id="registrosPendentes">0</div>
            <p class="descricao-card">Aguardando análise</p>
          </div>

          <div class="card-estatistica">
            <div class="card-header">
              <span class="card-titulo">Registros Finalizados</span>
              <svg class="icone-card icone-destructive" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
              </svg>
            </div>
            <div class="numero-principal numero-destructive" id="registrosFinalizados">0</div>
            <p class="descricao-card">Processamento concluído</p>
          </div>
        </div>
      </section>

      <!-- Filtros -->
      <section class="secao-filtros">
        <div class="card-filtros">
          <div class="filtros-conteudo">
            <div class="campo-pesquisa">
              <svg class="icone-pesquisa" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
              </svg>
              <input type="text" class="input-pesquisa" placeholder="Pesquisar registros..." id="campoPesquisa"
                oninput="filtrarRegistros()" />
            </div>

            <div class="campo-filtro">
              <select class="select-filtro" id="filtroStatus" onchange="filtrarRegistros()">
                <option value="">Todos os Status</option>
                <option value="ativo">Ativo</option>
                <option value="pendente">Pendente</option>
                <option value="finalizado">Finalizado</option>
              </select>
            </div>

            <div class="campo-filtro">
              <select class="select-filtro" id="filtroTipo" onchange="filtrarRegistros()">
                <option value="">Todos os Tipos</option>
                <option value="devolucao">Devolução</option>
                <option value="troca">Troca</option>
                <option value="reembolso">Reembolso</option>
              </select>
            </div>

            <button class="botao botao-outline" onclick="limparFiltros()">
              <svg class="icone" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
              </svg>
              Limpar
            </button>

            <!-- botão Exportar CSV -->
            <button class="botao botao-outline" type="button" onclick="exportarRegistros()" title="Exportar CSV">
              <svg class="icone" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M7 10l5 5m0 0l5-5m-5 5V4"/>
              </svg>
              Exportar
            </button>
            <!-- FIM Exportar -->
          </div>
        </div>
      </section>

      <!-- Lista de Registros -->
      <section class="secao-registros">
        <div class="container-registros" id="listaRegistros"></div>

        <div class="mensagem-vazia" id="mensagemVazia" style="display: none;">
          <div class="card-vazio">
            <svg class="icone-vazio" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
            </svg>
            <h3 class="titulo-vazio">Nenhum registro encontrado</h3>
            <p class="descricao-vazio">
              Não há registros que correspondam aos seus critérios de pesquisa.
              Tente ajustar os filtros ou criar um novo registro.
            </p>
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- Modal Novo/Editar Registro -->
  <div class="modal" id="modalRegistro" style="display: none;">
    <div class="modal-overlay" onclick="fecharModalRegistro()"></div>
    <div class="modal-conteudo">
      <div class="modal-header">
        <h2 class="modal-titulo" id="tituloModal">Novo Registro</h2>
        <p class="modal-descricao">Preencha os dados do registro</p>
        <button class="botao-fechar" onclick="fecharModalRegistro()">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>

      <form class="modal-form" id="formRegistro" onsubmit="salvarRegistro(event)">
        <div class="campo-form">
          <label class="label-form" for="nomeCliente">Nome do Cliente</label>
          <input type="text" id="nomeCliente" class="input-form" required />
        </div>

        <div class="campo-form">
          <label class="label-form" for="tipoRegistro">Tipo de Registro</label>
          <select id="tipoRegistro" class="select-filtro" required>
            <option value="">Selecione o tipo</option>
            <option value="devolucao">Devolução</option>
            <option value="troca">Troca</option>
            <option value="reembolso">Reembolso</option>
          </select>
        </div>

        <div class="campo-form">
          <label class="label-form" for="valorRegistro">Valor (R$)</label>
          <input type="number" id="valorRegistro" class="input-form" step="0.01" min="0" required />
        </div>

        <div class="campo-form">
          <label class="label-form" for="statusRegistro">Status</label>
          <select id="statusRegistro" class="select-filtro" required>
            <option value="">Selecione o status</option>
            <option value="em_analise">Em análise</option>
            <option value="aguardando_cliente">Aguardando cliente</option>
            <option value="aguardando_logistica">Aguardando logística</option>
            <option value="recebido_cd">Recebido no CD</option>
            <option value="em_inspecao">Em inspeção</option>
            <option value="aprovado">Aprovado</option>
            <option value="rejeitado">Rejeitado</option>
            <option value="concluido">Concluído</option>
          </select>
        </div>

        <div class="campo-form">
          <label class="label-form" for="descricaoRegistro">Descrição</label>
          <textarea id="descricaoRegistro" class="textarea-form" rows="3" required></textarea>
        </div>

        <div class="modal-acoes">
          <button type="button" class="botao botao-outline" onclick="fecharModalRegistro()">
            Cancelar
          </button>
          <button type="submit" class="botao botao-principal">
            <svg class="icone" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
            </svg>
            Salvar Registro
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast" style="display: none;">
    <div class="toast-conteudo">
      <div class="toast-icone">
        <svg fill="currentColor" viewBox="0 0 20 20">
          <path
            d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" />
        </svg>
      </div>
      <div>
        <div class="toast-titulo" id="toastTitulo">Sucesso!</div>
        <div class="toast-descricao" id="toastDescricao">Operação realizada com sucesso.</div>
      </div>
    </div>
  </div>

  <!-- scripts: carregar header (injeção do navbar) antes do código da página -->
  <script src="js/header.js" defer></script>
  <script src="js/registros.js" defer></script>
</body>
</html>
