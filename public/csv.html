<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CSV — Controle Fácil</title>
  <meta name="description" content="Sistema profissional de conciliação de devoluções do Mercado Livre via CSV"/>

  <!-- Fontes -->
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>

  <!-- Estilos globais -->
  <link rel="stylesheet" href="css/navigation.css"/>

  <!-- Estilos da página -->
  <link rel="stylesheet" href="css/csv.css"/>

  <link rel="shortcut icon" href="assets/img/logo_rf.png" type="image/png">
</head>
<body class="csv-page" data-page="csv">

  <!-- SIDEBAR -->
  <aside id="sidebar" class="sidebar" aria-label="Menu lateral">
    <div class="sidebar-header">
      <a href="home.html" class="sidebar-logo" aria-label="Retorno Fácil">
        <span class="sidebar-logo-text">Retorno Fácil</span>
      </a>
      <button id="sidebar-toggle" class="sidebar-toggle" aria-label="Alternar menu" title="Menu" aria-expanded="false">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <path d="M3 6h18M3 12h18M3 18h18"/>
        </svg>
      </button>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" data-page="home" href="home.html">
        <svg class="sidebar-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M3 10.5 12 3l9 7.5"/><path d="M5 10v10h14V10"/>
        </svg>
        <span class="sidebar-nav-text">Home</span>
      </a>

      <a class="sidebar-nav-item" data-page="central" href="central.html">
        <svg class="sidebar-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <rect x="3" y="3" width="7" height="7" rx="1"/>
          <rect x="14" y="3" width="7" height="7" rx="1"/>
          <rect x="14" y="14" width="7" height="7" rx="1"/>
          <rect x="3" y="14" width="7" height="7" rx="1"/>
        </svg>
        <span class="sidebar-nav-text">Central</span>
      </a>

      <a class="sidebar-nav-item" data-page="devolucoes" href="index.html">
        <svg class="sidebar-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <polyline points="9 14 4 9 9 4"/>
          <path d="M20 20v-7a4 4 0 0 0-4-4H4"/>
        </svg>
        <span class="sidebar-nav-text">Devoluções</span>
      </a>

      <a class="sidebar-nav-item" data-page="dashboards" href="dashboard.html">
        <svg class="sidebar-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <line x1="18" y1="20" x2="18" y2="10"/>
          <line x1="12" y1="20" x2="12" y2="4"/>
          <line x1="6" y1="20" x2="6" y2="14"/>
        </svg>
        <span class="sidebar-nav-text">Dashboards &amp; Relatórios</span>
      </a>

      <a class="sidebar-nav-item" data-page="logs" href="logs.html">
        <svg class="sidebar-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
          <polyline points="14 2 14 8 20 8"/>
          <line x1="16" y1="13" x2="8" y2="13"/>
          <line x1="16" y1="17" x2="8" y2="17"/>
        </svg>
        <span class="sidebar-nav-text">Log de Custos</span>
      </a>

      <!-- Página CSV destacada no menu -->
      <a class="sidebar-nav-item active" data-page="csv" href="csv.html" aria-current="page">
        <svg class="sidebar-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
          <polyline points="17 8 12 3 7 8"/>
          <line x1="12" y1="3" x2="12" y2="15"/>
        </svg>
        <span class="sidebar-nav-text">Upload CSV</span>
      </a>

      <a class="sidebar-nav-item" data-page="settings" href="settings/config.html">
        <svg class="sidebar-nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Z"/>
          <path d="M19.4 15a1 1 0 0 0 .2 1.1l.1.1a1 1 0 0 1-.2 1.6l-1.6.9a1 1 0 0 1-1.2-.1l-.1-.1a7.9 7.9 0 0 1-1 .6 1 1 0 0 0-.6.9l-.1 1.8a1 1 0 0 1-1 .9h-1.8a1 1 0 0 1-1-.9l-.1-1.8a1 1 0 0 0-.6-.9 7.9 7.9 0 0 1-1-.6 1 1 0 0 1-1.3.2l-1.6-.9a1 1 0 0 1-.3-1.6l.1-.1A1 1 0 0 0 4.6 15l-1.6-.9a1 1 0 0 1-.5-1.3l.7-1.7a1 1 0 0 1 1-.6h.2c.3-.2.6-.4.9-.6a1 1 0 0 0 .4-1l-.2-1.8A1 1 0 0 1 6.5 4H8.3a1 1 0 0 1 1 .9l.1 1.8a1 1 0 0 0 .6.9l1 .6 1-.6a1 1 0 0 0 .6-.9l.1-1.8a1 1 0 0 1 1-.9h1.8a1 1 0 0 1 1 .9l-.2 1.8a1 1 0 0 0 .4 1c.3.2.6.4.9.6h.2a1 1 0 0 1 1 .6l.7 1.7a1 1 0 0 1-.5 1.3Z"/>
        </svg>
        <span class="sidebar-nav-text">Configurações</span>
      </a>
    </nav>

    <div class="sidebar-footer">
      <div class="sidebar-user">
        <div class="sidebar-user-info">
          <div class="sidebar-user-name" id="sidebarUserName">—</div>
          <div class="sidebar-user-email" id="sidebarUserEmail">—</div>
        </div>
      </div>
      <button class="sidebar-logout" id="btnLogout" title="Sair" aria-label="Sair">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
          <path d="M16 17l5-5-5-5"/>
          <path d="M21 12H9"/>
        </svg>
      </button>
    </div>
  </aside>

  <!-- overlay único -->
  <div id="sidebar-overlay" class="sidebar-overlay" aria-hidden="true"></div>

  <!-- HEADER da página -->
  <header class="header">
    <div class="container">
      <div class="header-content">
        <div class="logo-area">
          <div class="logo-wrapper">
            <div class="logo-icon">
              <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                <polyline points="3.27 6.96 12 12.01 20.73 6.96"/>
                <line x1="12" y1="22.08" x2="12" y2="12"/>
              </svg>
            </div>
            <div class="logo-badge">
              <svg class="icon-small" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/>
              </svg>
            </div>
          </div>
          <div class="header-text">
            <h1 class="header-title">Retorno Fácil</h1>
            <p class="header-subtitle">Upload de CSV</p>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- CONTEÚDO -->
  <main class="main-content">
    <div class="container">
      <!-- Stats -->
      <section class="stats-section">
        <div class="stats-grid">
          <div class="stat-card" data-variant="default">
            <div class="stat-header">
              <span class="stat-title">Total de Devoluções</span>
              <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
              </svg>
            </div>
            <div class="stat-value" id="stat-total">5</div>
            <div class="stat-description">Registros no sistema</div>
          </div>

          <div class="stat-card" data-variant="warning">
            <div class="stat-header">
              <span class="stat-title">Pendentes</span>
              <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                <circle cx="12" cy="12" r="10"/>
                <polyline points="12 6 12 12 16 14"/>
              </svg>
            </div>
            <div class="stat-value" id="stat-pending">2</div>
            <div class="stat-description">Aguardando análise</div>
          </div>

          <div class="stat-card" data-variant="success">
            <div class="stat-header">
              <span class="stat-title">Aprovadas</span>
              <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                <polyline points="22 4 12 14.01 9 11.01"/>
              </svg>
            </div>
            <div class="stat-value" id="stat-approved">2</div>
            <div class="stat-description">Reembolso autorizado</div>
          </div>

          <div class="stat-card" data-variant="danger">
            <div class="stat-header">
              <span class="stat-title">Rejeitadas</span>
              <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                <circle cx="12" cy="12" r="10"/>
                <line x1="15" y1="9" x2="9" y2="15"/>
                <line x1="9" y1="9" x2="15" y2="15"/>
              </svg>
            </div>
            <div class="stat-value" id="stat-rejected">1</div>
            <div class="stat-description">Fora das políticas</div>
          </div>
        </div>
      </section>

      <!-- Upload -->
      <section class="upload-section">
        <div class="upload-card">
          <div class="upload-header">
            <h2 class="section-title">Upload de CSV</h2>
            <p class="section-description">Envie o relatório de pós-venda do Mercado Livre</p>
          </div>

          <div class="upload-area" id="uploadArea">
            <input type="file" id="fileInput" accept=".csv" hidden>
            <div class="upload-content">
              <div class="upload-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                  <polyline points="17 8 12 3 7 8"/>
                  <line x1="12" y1="3" x2="12" y2="15"/>
                </svg>
              </div>
              <p class="upload-text">Arraste e solte seu CSV</p>
              <p class="upload-subtext">ou clique para selecionar</p>
              <div class="file-selected" id="fileSelected" hidden>
                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                  <polyline points="14 2 14 8 20 8"/>
                </svg>
                <span id="fileName">arquivo.csv</span>
                <svg class="icon-success" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                  <polyline points="22 4 12 14.01 9 11.01"/>
                </svg>
              </div>
            </div>
          </div>

          <div class="upload-info">
            <svg class="info-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
              <circle cx="12" cy="12" r="10"/>
              <line x1="12" y1="16" x2="12" y2="12"/>
              <line x1="12" y1="8" x2="12.01" y2="8"/>
            </svg>
            <div class="info-text">
              <p class="info-title">Formato esperado</p>
              <p class="info-description">O CSV deve conter: ID da devolução, Data, SKU, Cliente, Motivo, Status e Valor</p>
            </div>
          </div>

          <div class="upload-actions" style="display:flex; gap:.5rem; flex-wrap:wrap; margin:.5rem 0 1rem;">
            <button class="btn btn-outline" id="btnTplDefault" type="button">Baixar modelo (default)</button>
            <button class="btn btn-outline" id="btnTplAC" type="button">Baixar modelo (after_collection)</button>

            <div class="idemp-wrap" style="display:flex; gap:.5rem; align-items:center;">
              <label for="idempBatch" style="font-size:.875rem; color:#64748b;">Idempotência do arquivo:</label>
              <input id="idempBatch" placeholder="ex.: LOTE-ML-2025-10-07" style="padding:.5rem .75rem; border:1px solid #e2e8f0; border-radius:.5rem; min-width:240px;">
            </div>
          </div>

          <button class="btn btn-primary btn-lg" id="uploadBtn" type="button" disabled>
            <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
              <polyline points="17 8 12 3 7 8"/>
              <line x1="12" y1="3" x2="12" y2="15"/>
            </svg>
            Enviar CSV
          </button>
        </div>
      </section>

      <!-- Filtros -->
      <section class="filter-section">
        <div class="filter-bar">
          <div class="search-input">
            <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
              <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
            </svg>
            <input type="text" id="searchInput" placeholder="Buscar por ID, SKU ou cliente...">
          </div>
          <select id="statusFilter" class="status-select" aria-label="Filtrar por status">
            <option value="all">Todos os status</option>
            <option value="pending">Pendente</option>
            <option value="approved">Aprovado</option>
            <option value="rejected">Rejeitado</option>
          </select>
        </div>
      </section>

      <!-- Lista -->
      <section class="returns-section">
        <div class="section-header">
          <h2 class="section-title">Devoluções Recentes</h2>
          <p class="section-subtitle" id="resultsCount">5 resultado(s) encontrado(s)</p>
        </div>

        <div class="returns-list" id="returnsList"><!-- cards via JS --></div>

        <div class="empty-state" id="emptyState" hidden>
          <svg class="empty-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
          </svg>
          <h3 class="empty-title">Nenhuma devolução encontrada</h3>
          <p class="empty-description">Tente ajustar os filtros ou fazer uma nova busca</p>
        </div>
      </section>
    </div>
  </main>

  <div class="toast-container" id="toastContainer" aria-live="polite" aria-atomic="true"></div>

  <!-- Scripts -->
  <script src="/js/auth-guard.js"></script>
  <script src="js/navigation.js" defer></script>
  <script src="js/csv.js" defer></script>
</body>
</html>
